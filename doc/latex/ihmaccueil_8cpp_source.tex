\hypertarget{ihmaccueil_8cpp_source}{}\subsection{ihmaccueil.\+cpp}
\label{ihmaccueil_8cpp_source}\index{ihmaccueil.\+cpp@{ihmaccueil.\+cpp}}

\begin{DoxyCode}
00001 
00007 \textcolor{preprocessor}{#include "\hyperlink{ihmaccueil_8h}{ihmaccueil.h}"}
00008 \textcolor{preprocessor}{#include "\hyperlink{ihmrov_8h}{ihmrov.h}"}
00009 \textcolor{preprocessor}{#include "\hyperlink{ihmcreationcampagne_8h}{ihmcreationcampagne.h}"}
00010 \textcolor{preprocessor}{#include "\hyperlink{campagne_8h}{campagne.h}"}
00011 \textcolor{preprocessor}{#include "\hyperlink{basededonnees_8h}{basededonnees.h}"}
00012 \textcolor{preprocessor}{#include <QMessageBox>}
00013 
\Hypertarget{ihmaccueil_8cpp_source_l00014}\hyperlink{class_i_h_m_accueil_a66cf4d5655e3132c1d313b76f3905e52}{00014} \hyperlink{class_i_h_m_accueil_a66cf4d5655e3132c1d313b76f3905e52}{IHMAccueil::IHMAccueil}(\hyperlink{class_q_widget}{QWidget} *parent) : \hyperlink{class_q_widget}{QWidget}(parent), 
      campagnesEnCours()
00015 \{
00016     qDebug() << Q\_FUNC\_INFO;
00017     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees} = \hyperlink{class_base_de_donnees_a58beb2f702f75b257e2e55e25d9f979b}{BaseDeDonnees::getInstance}();
00018 
00019     \hyperlink{class_i_h_m_accueil_a1385a94c1a3d75d813429dc9bdc4b050}{initialisationWidgets}();
00020     \hyperlink{class_i_h_m_accueil_a5a571ab8f264c275580501753bb00674}{initialiserEvenements}();
00021     \hyperlink{class_i_h_m_accueil_acaaa5d756165801403ea7d73ae40186b}{initialiserLayouts}();
00022     \hyperlink{class_i_h_m_accueil_a63bc796a325066423ed6146b8bab1437}{configurerWidgets}();
00023 
00024     \hyperlink{class_i_h_m_accueil_a1ed3efefdf929c0d2a6b6d1bb10bbc27}{chargerCampagnes}();
00025     \hyperlink{class_i_h_m_accueil_a44074f2d8d59e0d1b7a3d50c24d2a0df}{rechargerListeCampagnes}();
00026 
00027     \hyperlink{class_i_h_m_accueil_af9f2613056b21bdf82e8f54a26146acc}{ihmRov} = \textcolor{keyword}{new} \hyperlink{class_i_h_m_rov}{IHMRov}(\textcolor{keyword}{this});
00028     \hyperlink{class_i_h_m_accueil_af9f2613056b21bdf82e8f54a26146acc}{ihmRov}->hide();
00029 \}
00030 
\Hypertarget{ihmaccueil_8cpp_source_l00031}\hyperlink{class_i_h_m_accueil_a5ea3926747dada8b9677ab9a33c03139}{00031} \hyperlink{class_i_h_m_accueil_a5ea3926747dada8b9677ab9a33c03139}{IHMAccueil::~IHMAccueil}()
00032 \{
00033     \hyperlink{class_base_de_donnees_a457401c0816b888c77ce915997545f4e}{BaseDeDonnees::detruireInstance}();
00034     qDebug() << Q\_FUNC\_INFO;
00035 \}
00036 
\Hypertarget{ihmaccueil_8cpp_source_l00037}\hyperlink{class_i_h_m_accueil_a1385a94c1a3d75d813429dc9bdc4b050}{00037} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a1385a94c1a3d75d813429dc9bdc4b050}{IHMAccueil::initialisationWidgets}()
00038 \{
00039     \hyperlink{class_i_h_m_accueil_a313a8c52763aa2978010db77ec6673ac}{boutonArchives} = \textcolor{keyword}{new} QPushButton(\textcolor{stringliteral}{"Archives"}, \textcolor{keyword}{this});
00040     \hyperlink{class_i_h_m_accueil_a8b8ed7d11ab66e3c6895b3c6129dc9c8}{boutonConfiguration} = \textcolor{keyword}{new} QPushButton(\textcolor{stringliteral}{"Configuration"}, \textcolor{keyword}{this});
00041     \hyperlink{class_i_h_m_accueil_a4186b4ef6a9c63f5b3c6431626ff3268}{boutonCreationCampagne} = \textcolor{keyword}{new} QPushButton(\textcolor{stringliteral}{"Créer campagne"}, \textcolor{keyword}{this});
00042     \hyperlink{class_i_h_m_accueil_a9fd8ab3abc0c1e6addd70c8d7c46fb65}{boutonDemarrerCampagne} = \textcolor{keyword}{new} QPushButton(\textcolor{stringliteral}{"Démarrer"}, \textcolor{keyword}{this});
00043     \hyperlink{class_i_h_m_accueil_a96d64cf254c0645eb45c317858b0a0f3}{boutonArchiverCampagne} = \textcolor{keyword}{new} QPushButton(\textcolor{stringliteral}{"Archiver"}, \textcolor{keyword}{this});
00044     \hyperlink{class_i_h_m_accueil_afb409fb4395372f35f9f8699fcb4c89b}{boutonSupprimerCampagne} = \textcolor{keyword}{new} QPushButton(\textcolor{stringliteral}{"Supprimer"}, \textcolor{keyword}{this});
00045     \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne} = \textcolor{keyword}{new} QComboBox(\textcolor{keyword}{this});
00046     \hyperlink{class_i_h_m_accueil_a709440124f3307589eee68c517833e6d}{logoAccueil} = \textcolor{keyword}{new} QLabel(\textcolor{keyword}{this});
00047 
00048 \}
\Hypertarget{ihmaccueil_8cpp_source_l00049}\hyperlink{class_i_h_m_accueil_acaaa5d756165801403ea7d73ae40186b}{00049} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_acaaa5d756165801403ea7d73ae40186b}{IHMAccueil::initialiserLayouts}()
00050 \{
00051     QVBoxLayout *layoutPrincipal = \textcolor{keyword}{new} QVBoxLayout;
00052     QHBoxLayout *layoutSuperieur = \textcolor{keyword}{new} QHBoxLayout;
00053     QVBoxLayout *layoutCentral = \textcolor{keyword}{new} QVBoxLayout;
00054     QHBoxLayout *layoutConfigurationCampagne = \textcolor{keyword}{new} QHBoxLayout;
00055     QHBoxLayout *layoutCampagne = \textcolor{keyword}{new} QHBoxLayout;
00056 
00057     layoutPrincipal->addLayout(layoutSuperieur);
00058     layoutPrincipal->addLayout(layoutCentral);
00059     layoutPrincipal->addLayout(layoutConfigurationCampagne);
00060     layoutPrincipal->addLayout(layoutCampagne);
00061 
00062     layoutCentral->setAlignment(Qt::AlignCenter);
00063 
00064     layoutSuperieur->addWidget(\hyperlink{class_i_h_m_accueil_a313a8c52763aa2978010db77ec6673ac}{boutonArchives});
00065     layoutSuperieur->addWidget(\hyperlink{class_i_h_m_accueil_a8b8ed7d11ab66e3c6895b3c6129dc9c8}{boutonConfiguration});
00066     layoutCentral->addWidget(\hyperlink{class_i_h_m_accueil_a709440124f3307589eee68c517833e6d}{logoAccueil});
00067     layoutConfigurationCampagne->addWidget(\hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne});
00068     layoutConfigurationCampagne->addWidget(\hyperlink{class_i_h_m_accueil_a96d64cf254c0645eb45c317858b0a0f3}{boutonArchiverCampagne});
00069     layoutConfigurationCampagne->addWidget(\hyperlink{class_i_h_m_accueil_afb409fb4395372f35f9f8699fcb4c89b}{boutonSupprimerCampagne});
00070     layoutCampagne->addWidget(\hyperlink{class_i_h_m_accueil_a4186b4ef6a9c63f5b3c6431626ff3268}{boutonCreationCampagne});
00071     layoutCampagne->addWidget(\hyperlink{class_i_h_m_accueil_a9fd8ab3abc0c1e6addd70c8d7c46fb65}{boutonDemarrerCampagne});
00072 
00073     setLayout(layoutPrincipal);
00074     setWindowTitle(\hyperlink{ihmaccueil_8h_a26ff7f60eb1bfd16fed17fed2d65c865}{NOM\_FENETRE\_ACCUEIL});
00075 \}
00076 
\Hypertarget{ihmaccueil_8cpp_source_l00077}\hyperlink{class_i_h_m_accueil_a63bc796a325066423ed6146b8bab1437}{00077} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a63bc796a325066423ed6146b8bab1437}{IHMAccueil::configurerWidgets}()
00078 \{
00079     qDebug() << Q\_FUNC\_INFO << qApp->applicationDirPath() + \textcolor{stringliteral}{"/images/Robot.png"};
00080     \hyperlink{class_i_h_m_accueil_a709440124f3307589eee68c517833e6d}{logoAccueil}->setPixmap(QPixmap(qApp->applicationDirPath() + \textcolor{stringliteral}{"/images/Robot.png"}));
00081     \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->setEditable(\textcolor{keyword}{false});
00082 \}
00083 
\Hypertarget{ihmaccueil_8cpp_source_l00084}\hyperlink{class_i_h_m_accueil_a5a571ab8f264c275580501753bb00674}{00084} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a5a571ab8f264c275580501753bb00674}{IHMAccueil::initialiserEvenements}()
00085 \{
00086     connect(\hyperlink{class_i_h_m_accueil_a9fd8ab3abc0c1e6addd70c8d7c46fb65}{boutonDemarrerCampagne}, SIGNAL(clicked()), \textcolor{keyword}{this}, SLOT(
      \hyperlink{class_i_h_m_accueil_a6e8935ff4e0ba8f0c0015f370d91eda3}{demarrerCampagne}()));
00087     connect(\hyperlink{class_i_h_m_accueil_a4186b4ef6a9c63f5b3c6431626ff3268}{boutonCreationCampagne}, SIGNAL(clicked()), \textcolor{keyword}{this}, SLOT(
      \hyperlink{class_i_h_m_accueil_a1da45b17d6e4198f87a9a0e05d1f7fd5}{creerCampagne}()));
00088     connect(\hyperlink{class_i_h_m_accueil_afb409fb4395372f35f9f8699fcb4c89b}{boutonSupprimerCampagne}, SIGNAL(clicked()), \textcolor{keyword}{this}, SLOT(
      \hyperlink{class_i_h_m_accueil_a0d7c77277fe83ad13beee56d96c5c5ca}{supprimerCampagne}()));
00089     connect(\hyperlink{class_i_h_m_accueil_a96d64cf254c0645eb45c317858b0a0f3}{boutonArchiverCampagne}, SIGNAL(clicked()), \textcolor{keyword}{this}, SLOT(
      \hyperlink{class_i_h_m_accueil_a5d38917dbe88751ee966834e1f6c558e}{archiverCampagne}()));
00090 \}
00091 
\Hypertarget{ihmaccueil_8cpp_source_l00092}\hyperlink{class_i_h_m_accueil_a44074f2d8d59e0d1b7a3d50c24d2a0df}{00092} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a44074f2d8d59e0d1b7a3d50c24d2a0df}{IHMAccueil::rechargerListeCampagnes}()
00093 \{
00094     \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->clear();
00095 
00096     \textcolor{keywordflow}{for}(QVector<Campagne*>::iterator it = \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.begin(); it != 
      \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.end(); it++)
00097     \{
00098         \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->addItem((*it)->getNomCampagne());
00099     \}
00100 
00101     \textcolor{keywordflow}{if}(\hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->currentText().isEmpty())
00102     \{
00103         \hyperlink{class_i_h_m_accueil_a9fd8ab3abc0c1e6addd70c8d7c46fb65}{boutonDemarrerCampagne}->setDisabled(\textcolor{keyword}{true});
00104         \hyperlink{class_i_h_m_accueil_a96d64cf254c0645eb45c317858b0a0f3}{boutonArchiverCampagne}->setDisabled(\textcolor{keyword}{true});
00105         \hyperlink{class_i_h_m_accueil_afb409fb4395372f35f9f8699fcb4c89b}{boutonSupprimerCampagne}->setDisabled(\textcolor{keyword}{true});
00106     \}
00107     \textcolor{keywordflow}{else}
00108     \{
00109         \hyperlink{class_i_h_m_accueil_a9fd8ab3abc0c1e6addd70c8d7c46fb65}{boutonDemarrerCampagne}->setEnabled(\textcolor{keyword}{true});
00110         \hyperlink{class_i_h_m_accueil_a96d64cf254c0645eb45c317858b0a0f3}{boutonArchiverCampagne}->setEnabled(\textcolor{keyword}{true});
00111         \hyperlink{class_i_h_m_accueil_afb409fb4395372f35f9f8699fcb4c89b}{boutonSupprimerCampagne}->setEnabled(\textcolor{keyword}{true});
00112     \}
00113 \}
00114 
\Hypertarget{ihmaccueil_8cpp_source_l00115}\hyperlink{class_i_h_m_accueil_aa09878b2e3e3024220291165b5c528a6}{00115} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_aa09878b2e3e3024220291165b5c528a6}{IHMAccueil::recupererNbPhotos}(QString &nombrePhotos, QString &
      requeteNombrePhotos)
00116 \{
00117     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteNombrePhotos, nombrePhotos);
00118 \}
00119 
\Hypertarget{ihmaccueil_8cpp_source_l00120}\hyperlink{class_i_h_m_accueil_a0ffb0f0c7c9c613083933514690f2772}{00120} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a0ffb0f0c7c9c613083933514690f2772}{IHMAccueil::recupererCampagneEnCours}(\textcolor{keywordtype}{bool} &retourCampagne, QString
       &requeteInformationsCampagne, QVector<QStringList> &\hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours})
00121 \{
00122     retourCampagne = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteInformationsCampagne, 
      campagnesEnCours);
00123 \}
00124 
\Hypertarget{ihmaccueil_8cpp_source_l00125}\hyperlink{class_i_h_m_accueil_aebeef48b9bc345edd02e5185951c454e}{00125} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_aebeef48b9bc345edd02e5185951c454e}{IHMAccueil::recupererPhotos}(\textcolor{keywordtype}{bool} &retourPhoto, QString &
      requeteInformationsPhotos, QVector<QStringList> &informationsPhotos)
00126 \{
00127     retourPhoto = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteInformationsPhotos, 
      informationsPhotos);
00128 \}
00129 
\Hypertarget{ihmaccueil_8cpp_source_l00130}\hyperlink{class_i_h_m_accueil_a1ed3efefdf929c0d2a6b6d1bb10bbc27}{00130} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a1ed3efefdf929c0d2a6b6d1bb10bbc27}{IHMAccueil::chargerCampagnes}()
00131 \{
00132     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a7f6a5510b08017b0d99115a84252f186}{ouvrir}(\textcolor{stringliteral}{"campagnes.sqlite"});
00133 
00134     \textcolor{keywordtype}{bool} retourCampagne, retourPhoto;
00135     QVector<QStringList> \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours};
00136     QString nombrePhotos;
00137     QVector<QStringList> informationsPhotos;
00138 
00139     QString requeteInformationsCampagne = \textcolor{stringliteral}{"SELECT campagne.idCampagne, campagne.nom, campagne.lieu,
       technicien.nom, technicien.prenom, campagne.date, campagne.duree, campagne.cheminSauvegarde FROM campagne INNER
       JOIN technicien ON campagne.idTechnicien = technicien.idTechnicien WHERE campagne.enCours = '1' ORDER BY
       campagne.date DESC"};
00140 
00141 \textcolor{preprocessor}{    #ifdef DEBUG\_BASEDEDONNEES}
00142     qDebug() << Q\_FUNC\_INFO << QString::fromUtf8(\textcolor{stringliteral}{"requête : "}) << requeteInformationsCampagne;
00143 \textcolor{preprocessor}{    #endif}
00144 
00145     \hyperlink{class_i_h_m_accueil_a0ffb0f0c7c9c613083933514690f2772}{recupererCampagneEnCours}(retourCampagne, requeteInformationsCampagne, 
      campagnesEnCours);
00146     \textcolor{keywordflow}{if}(retourCampagne)
00147     \{
00148         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i < campagnesEnCours.size(); i++)
00149         \{
00150             QStringList informationsCampagne = campagnesEnCours.at(i);
00151             QString requeteNombrePhotos = \textcolor{stringliteral}{"SELECT COUNT(IdPhoto) FROM photo INNER JOIN campagne ON
       photo.IdCampagne = campagne.IdCampagne WHERE campagne.IdCampagne = '"} + informationsCampagne.at(0) + \textcolor{stringliteral}{"' "};
00152             \hyperlink{class_i_h_m_accueil_aa09878b2e3e3024220291165b5c528a6}{recupererNbPhotos}(nombrePhotos, requeteNombrePhotos);
00153 
00154 \textcolor{preprocessor}{            #ifdef DEBUG\_BASEDEDONNEES}
00155             qDebug() << Q\_FUNC\_INFO << QString::fromUtf8(\textcolor{stringliteral}{"%0 %1 %2 %3 %4 %5 %6 %7"}).arg(
      informationsCampagne.at(0)).arg(informationsCampagne.at(1)).arg(informationsCampagne.at(2)).arg(informationsCampagne.at(3)).arg
      (informationsCampagne.at(4)).arg(informationsCampagne.at(5)).arg(informationsCampagne.at(6)).arg(
      informationsCampagne.at(7));
00156 \textcolor{preprocessor}{            #endif}
00157             \hyperlink{class_campagne}{Campagne} *campagne = \textcolor{keyword}{new} \hyperlink{class_campagne}{Campagne}(informationsCampagne.at(1), 
      informationsCampagne.at(2), informationsCampagne.at(3), informationsCampagne.at(4), QDateTime::fromString(
      informationsCampagne.at(5)), \textcolor{keyword}{this}, informationsCampagne.at(6).toInt());
00158 
00159             campagne->\hyperlink{class_campagne_a68c7eb6776e46306b10f1ca2a409ae6e}{setCheminSauvegarde}(informationsCampagne.at(7));
00160             campagne->\hyperlink{class_campagne_a2b8848ade0f97708571331ef71e4c9cb}{setNombrePhotos}(nombrePhotos.toInt());
00161 
00162             QString requeteInformationsPhotos =\textcolor{stringliteral}{"SELECT cheminImage, aGarder FROM photo INNER JOIN campagne
       ON photo.IdCampagne = campagne.IdCampagne WHERE campagne.enCours = '1' AND photo.IdCampagne = '"} + 
      informationsCampagne.at(0) + \textcolor{stringliteral}{"'"};
00163             \hyperlink{class_i_h_m_accueil_aebeef48b9bc345edd02e5185951c454e}{recupererPhotos}(retourPhoto, requeteInformationsPhotos, informationsPhotos);
00164             \textcolor{keywordflow}{if}(retourPhoto)
00165             \{
00166                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i < informationsPhotos.size(); i++)
00167                 \{
00168                     QStringList informationPhoto = informationsPhotos.at(i);
00169                     \hyperlink{struct_photo}{Photo} photo;
00170                     photo.\hyperlink{struct_photo_a3c28eb9ad160b65deb46a72146a1d14f}{cheminSauvegarde} = informationPhoto.at(0);
00171                     photo.\hyperlink{struct_photo_afec1baefdd7d036432494bbb33b21366}{aGarder} = informationPhoto.at(1).toInt();
00172                     photo.\hyperlink{struct_photo_aa6ecfed8082bea5af2905208308a6adb}{image} = QPixmap(informationPhoto.at(0));
00173 
00174                     campagne->\hyperlink{class_campagne_a472029bf46646d136a750dbaa7a3155f}{ajouterPhoto}(photo);
00175                 \}
00176             \}
00177             \hyperlink{class_i_h_m_accueil_a3087ce7a78561c79ce3148761750dd1d}{ajouterCampagne}(campagne);
00178             informationsPhotos.clear();
00179         \}
00180      \}
00181      \textcolor{keywordflow}{else}
00182      \{
00183 \textcolor{preprocessor}{        #ifdef DEBUG\_BASEDEDONNEES}
00184         qDebug() << Q\_FUNC\_INFO << QString::fromUtf8(\textcolor{stringliteral}{"erreur !"});
00185 \textcolor{preprocessor}{        #endif}
00186      \}
00187 \}
00188 
\Hypertarget{ihmaccueil_8cpp_source_l00189}\hyperlink{class_i_h_m_accueil_a36ce6ecca4e258562577bab1439e0a96}{00189} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a36ce6ecca4e258562577bab1439e0a96}{IHMAccueil::supprimerCampagneListe}()
00190 \{
00191     \textcolor{keywordtype}{int} nbCampagnes = \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.size();
00192     \textcolor{keywordtype}{int} n = 0;
00193     \textcolor{keywordflow}{for}(QVector<Campagne*>::iterator it = \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.begin(); n < nbCampagnes; it++)
00194     \{
00195         \textcolor{keywordflow}{if}((*it)->getNomCampagne() == \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->currentText())
00196         \{
00197             \textcolor{keyword}{delete} (*it);
00198             \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.erase(it);
00199         \}
00200         n++;
00201     \}
00202     \hyperlink{class_i_h_m_accueil_a44074f2d8d59e0d1b7a3d50c24d2a0df}{rechargerListeCampagnes}();
00203 \}
00204 
\Hypertarget{ihmaccueil_8cpp_source_l00205}\hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{00205} QString \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{IHMAccueil::recupererIdCampagne}()
00206 \{
00207     \textcolor{keywordtype}{bool} retourRequeteIdCampagne;
00208     QString idCampagne;
00209     QString requeteIdCampagne = \textcolor{stringliteral}{"SELECT idCampagne FROM campagne WHERE campagne.nom = '"} + 
      \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->currentText() + \textcolor{stringliteral}{"'"};
00210 
00211     retourRequeteIdCampagne = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteIdCampagne, idCampagne)
      ;
00212 
00213     \textcolor{keywordflow}{if}(!retourRequeteIdCampagne)
00214     \{
00215 \textcolor{preprocessor}{        #ifdef DEBUG\_BASEDEDONNEES}
00216             qDebug() << Q\_FUNC\_INFO << QString::fromUtf8(\textcolor{stringliteral}{"erreur !"});
00217 \textcolor{preprocessor}{        #endif}
00218         \textcolor{keywordflow}{return} \textcolor{stringliteral}{"0"};
00219     \}
00220     \textcolor{keywordflow}{else}
00221         \textcolor{keywordflow}{return} idCampagne;
00222 \}
00223 
\Hypertarget{ihmaccueil_8cpp_source_l00224}\hyperlink{class_i_h_m_accueil_a9dc22241cd0d4a227b8b0bf04c6404fd}{00224} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a9dc22241cd0d4a227b8b0bf04c6404fd}{IHMAccueil::supprimerPhotoLocal}(QString requete)
00225 \{
00226     QVector<QString> photoASupprimer;
00227     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requete, photoASupprimer);
00228     \textcolor{keywordflow}{for}(QVector<QString>::Iterator it = photoASupprimer.begin(); it != photoASupprimer.end(); ++it)
00229     \{
00230        QFile::remove((*it));
00231     \}
00232 \}
00233 
\Hypertarget{ihmaccueil_8cpp_source_l00234}\hyperlink{class_i_h_m_accueil_acb9679f51e140e0bc28d8ac10afd87e9}{00234} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_acb9679f51e140e0bc28d8ac10afd87e9}{IHMAccueil::supprimerDossierPhotoLocal}()
00235 \{
00236     QDir qDir;
00237 
00238     \textcolor{keywordflow}{for}(QVector<Campagne*>::Iterator it = \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.begin(); it != 
      \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.end(); ++it)
00239     \{
00240         \textcolor{keywordflow}{if}((*it)->getNomCampagne() == \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->currentText())
00241         \{
00242             \textcolor{keywordflow}{if}(qDir.exists((*it)->getCheminSauvegarde() + \textcolor{stringliteral}{"/"} + (*it)->getNomCampagne()))
00243             \{
00244                 \textcolor{keywordflow}{if}(!qDir.rmdir((*it)->getCheminSauvegarde() + \textcolor{stringliteral}{"/"} + (*it)->getNomCampagne()))
00245                 \{
00246                     qDebug() << Q\_FUNC\_INFO << \textcolor{stringliteral}{"Erreur : impossible de supprimer le dossier"} << (*it)->
      getCheminSauvegarde() + \textcolor{stringliteral}{"/"} + (*it)->getNomCampagne();
00247                     QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Erreur"}, \textcolor{stringliteral}{"Erreur : impossible de supprimer le dossier "} + 
      (*it)->getCheminSauvegarde() + \textcolor{stringliteral}{"/"} + (*it)->getNomCampagne() + \textcolor{stringliteral}{" !"});
00248                 \}
00249             \}
00250         \}
00251     \}
00252 \}
00253 
\Hypertarget{ihmaccueil_8cpp_source_l00254}\hyperlink{class_i_h_m_accueil_a3087ce7a78561c79ce3148761750dd1d}{00254} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a3087ce7a78561c79ce3148761750dd1d}{IHMAccueil::ajouterCampagne}(\hyperlink{class_campagne}{Campagne} *campagne, \textcolor{keywordtype}{bool} verification)
00255 \{
00256     QDir dossierCampagne(campagne->\hyperlink{class_campagne_ad752790357417d83a93056d9c9689a16}{getCheminSauvegarde}());
00257     \textcolor{keywordflow}{if}(dossierCampagne.exists())
00258     \{
00259         \textcolor{keywordflow}{if}(!dossierCampagne.mkdir(campagne->\hyperlink{class_campagne_a99a682fcb8e5a3f8c2aff7a44eb2c930}{getNomCampagne}()))
00260         \{
00261             qDebug() << Q\_FUNC\_INFO << \textcolor{stringliteral}{"Erreur : impossible de créer le dossier"} << campagne->
      \hyperlink{class_campagne_ad752790357417d83a93056d9c9689a16}{getCheminSauvegarde}() << \textcolor{stringliteral}{"campagne"} << campagne->
      \hyperlink{class_campagne_a99a682fcb8e5a3f8c2aff7a44eb2c930}{getNomCampagne}();
00262             \textcolor{keywordflow}{if}(verification)
00263             \{
00264                 QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Erreur"}, \textcolor{stringliteral}{"Erreur : impossible de créer le dossier "} + campagne
      ->\hyperlink{class_campagne_ad752790357417d83a93056d9c9689a16}{getCheminSauvegarde}() + \textcolor{stringliteral}{" !"});
00265                 \textcolor{keywordflow}{return};
00266             \}
00267         \}
00268     \}
00269     \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.push\_back(campagne);
00270     \hyperlink{class_i_h_m_accueil_a44074f2d8d59e0d1b7a3d50c24d2a0df}{rechargerListeCampagnes}();
00271 \}
00272 
\Hypertarget{ihmaccueil_8cpp_source_l00273}\hyperlink{class_i_h_m_accueil_a5ab04fc3fa87817bec130f377d563b75}{00273} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a5ab04fc3fa87817bec130f377d563b75}{IHMAccueil::enregistrerCampagneBDD}(
      \hyperlink{class_campagne}{Campagne} *campagne)
00274 \{
00275 \textcolor{preprocessor}{    #ifdef DEBUG\_BASEDEDONNEES}
00276     qDebug() << Q\_FUNC\_INFO << campagne->\hyperlink{class_campagne_a99a682fcb8e5a3f8c2aff7a44eb2c930}{getNomCampagne}();
00277 \textcolor{preprocessor}{    #endif}
00278 
00279     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a7f6a5510b08017b0d99115a84252f186}{ouvrir}(\textcolor{stringliteral}{"campagnes.sqlite"});
00280 
00281     QString idTechnicien;
00282     QString requeteId = \textcolor{stringliteral}{"SELECT technicien.IdTechnicien FROM technicien WHERE technicien.nom = '"} + 
      campagne->\hyperlink{class_campagne_ae1df1bd6234222ccdaf5a1d20d64ee46}{getNomTechnicien}() + \textcolor{stringliteral}{"' AND technicien.prenom = '"} + campagne->
      \hyperlink{class_campagne_ac6c7772ef5d7b15964664d659b486263}{getPrenomTechnicien}() + \textcolor{stringliteral}{"'"};
00283     \textcolor{keywordtype}{bool} retour = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteId, idTechnicien);
00284     \textcolor{keywordflow}{if}(!retour)
00285     \{
00286         QString requeteInformation = \textcolor{stringliteral}{"INSERT INTO technicien (nom, prenom) VALUES ('"} + campagne->
      \hyperlink{class_campagne_ae1df1bd6234222ccdaf5a1d20d64ee46}{getNomTechnicien}() + \textcolor{stringliteral}{"','"} + campagne->\hyperlink{class_campagne_ac6c7772ef5d7b15964664d659b486263}{getPrenomTechnicien}() + \textcolor{stringliteral}{"')"};
00287         \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteInformation);
00288         \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteId, idTechnicien);
00289     \}
00290 
00291     QString requeteInsertionCampagne = \textcolor{stringliteral}{"INSERT INTO campagne (idTechnicien, nom, lieu, date, duree,
       enCours, cheminSauvegarde) VALUES ('"} + idTechnicien + \textcolor{stringliteral}{"', '"} + campagne->\hyperlink{class_campagne_a99a682fcb8e5a3f8c2aff7a44eb2c930}{getNomCampagne}() + \textcolor{stringliteral}{"', '"} +
       campagne->\hyperlink{class_campagne_a98d71a731d16dec7a882787387b29d8e}{getLieu}() + \textcolor{stringliteral}{"', '"} + campagne->\hyperlink{class_campagne_a319b5bb4ed2b0fc1a10fc4d099a7a6d2}{getDate}().toString() + \textcolor{stringliteral}{"', '"} + QString::number(
      campagne->\hyperlink{class_campagne_abe02a9050f4a5ea9521dd40b855c350b}{getDuree}()) + \textcolor{stringliteral}{"', '1', '"} + campagne->\hyperlink{class_campagne_ad752790357417d83a93056d9c9689a16}{getCheminSauvegarde}() + \textcolor{stringliteral}{"')"};
00292     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteInsertionCampagne);
00293 \}
00294 
\Hypertarget{ihmaccueil_8cpp_source_l00295}\hyperlink{class_i_h_m_accueil_a7f1e5f71843a99cb44e3efb7191a6d07}{00295} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a7f1e5f71843a99cb44e3efb7191a6d07}{IHMAccueil::modifierCampagneBDD}(\hyperlink{class_campagne}{Campagne} *campagne)
00296 \{
00297     QString idCampagne, requeteUpdateDuree, requeteIdCampagne, requeteInsertionMesures, 
      requeteModifierPhotos;
00298 
00299     requeteUpdateDuree = \textcolor{stringliteral}{"UPDATE campagne SET duree = '"}+ QString::number(campagne->
      \hyperlink{class_campagne_abe02a9050f4a5ea9521dd40b855c350b}{getDuree}()) + \textcolor{stringliteral}{"' WHERE campagne.nom = '"} + campagne->\hyperlink{class_campagne_a99a682fcb8e5a3f8c2aff7a44eb2c930}{getNomCampagne}() + \textcolor{stringliteral}{"'"};
00300     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteUpdateDuree);
00301 
00302     requeteIdCampagne = \textcolor{stringliteral}{"SELECT campagne.idCampagne FROM campagne WHERE campagne.nom = '"} + campagne->
      \hyperlink{class_campagne_a99a682fcb8e5a3f8c2aff7a44eb2c930}{getNomCampagne}() + \textcolor{stringliteral}{"'"};
00303     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteIdCampagne, idCampagne);
00304 
00305     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i =0; i < campagne->\hyperlink{class_campagne_abec90fcbc0c4ded45caaac9adb454add}{getAlbumPhoto}().size(); ++i)
00306     \{
00307         requeteModifierPhotos = \textcolor{stringliteral}{"UPDATE photo set aGarder = '"} + QString::number(campagne->
      \hyperlink{class_campagne_abec90fcbc0c4ded45caaac9adb454add}{getAlbumPhoto}()[i].aGarder) + \textcolor{stringliteral}{"' WHERE cheminImage = '"} + campagne->
      \hyperlink{class_campagne_abec90fcbc0c4ded45caaac9adb454add}{getAlbumPhoto}()[i].cheminSauvegarde + \textcolor{stringliteral}{"'"};
00308         \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteModifierPhotos);
00309     \}
00310     campagne->\hyperlink{class_campagne_a77066423e53f99bb6cd39fd25a6f2b5f}{supprimerMesures}();
00311 \}
00312 
\Hypertarget{ihmaccueil_8cpp_source_l00313}\hyperlink{class_i_h_m_accueil_aa27c7334efe44c8c4cd582df6581fdff}{00313} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_aa27c7334efe44c8c4cd582df6581fdff}{IHMAccueil::ajouterPhotoBDD}(\hyperlink{struct_photo}{Photo} &photo, 
      \hyperlink{class_campagne}{Campagne} *campagne)
00314 \{
00315     QString idCampagne;
00316     QString requeteIdCampagne = \textcolor{stringliteral}{"SELECT IdCampagne FROM campagne WHERE campagne.nom = '"} + campagne->
      \hyperlink{class_campagne_a99a682fcb8e5a3f8c2aff7a44eb2c930}{getNomCampagne}() + \textcolor{stringliteral}{"'"};
00317     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requeteIdCampagne, idCampagne);
00318 
00319     QString requeteInsertion = \textcolor{stringliteral}{"INSERT INTO photo (idCampagne, cheminImage, aGarder) VALUES ('"} + 
      idCampagne + \textcolor{stringliteral}{"', '"} + photo.\hyperlink{struct_photo_a3c28eb9ad160b65deb46a72146a1d14f}{cheminSauvegarde} + \textcolor{stringliteral}{"', '1')"};
00320     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteInsertion);
00321 \}
00322 
\Hypertarget{ihmaccueil_8cpp_source_l00323}\hyperlink{class_i_h_m_accueil_a6e8935ff4e0ba8f0c0015f370d91eda3}{00323} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a6e8935ff4e0ba8f0c0015f370d91eda3}{IHMAccueil::demarrerCampagne}()
00324 \{
00325     \textcolor{keywordflow}{for}(QVector<Campagne*>::iterator it = \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.begin(); it != 
      \hyperlink{class_i_h_m_accueil_ad3827b81480eb201b5927c16a2ad1c46}{campagnesEnCours}.end(); it++)
00326     \{
00327         \textcolor{keywordflow}{if}((*it)->getNomCampagne() == \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->currentText())
00328         \{
00329             qDebug() << Q\_FUNC\_INFO << \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->currentText();
00330             \hyperlink{class_i_h_m_accueil_af9f2613056b21bdf82e8f54a26146acc}{ihmRov}->\hyperlink{class_i_h_m_rov_a301a0b8cb323c2c9de71df9070bb7555}{setCampagne}(*it);
00331             \hyperlink{class_i_h_m_accueil_af9f2613056b21bdf82e8f54a26146acc}{ihmRov}->show();
00332             \hyperlink{class_i_h_m_accueil_af9f2613056b21bdf82e8f54a26146acc}{ihmRov}->\hyperlink{class_i_h_m_rov_a3660d3b4bf61367534eae9d0c3618a5e}{gererCampagne}();
00333             this->setVisible(\textcolor{keyword}{false});
00334             \textcolor{keywordflow}{break};
00335         \}
00336     \}    
00337 \}
00338 
\Hypertarget{ihmaccueil_8cpp_source_l00339}\hyperlink{class_i_h_m_accueil_a1da45b17d6e4198f87a9a0e05d1f7fd5}{00339} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a1da45b17d6e4198f87a9a0e05d1f7fd5}{IHMAccueil::creerCampagne}()
00340 \{
00341     QVector<QStringList> listeTechniciens;
00342     QString requete = \textcolor{stringliteral}{"SELECT technicien.nom, technicien.prenom FROM technicien"};
00343 
00344     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a77539baad389f5acf754cd2cd452403e}{recuperer}(requete, listeTechniciens);
00345 
00346     \hyperlink{class_i_h_m_creation_campagne}{IHMCreationCampagne} *ihmCreationCampagne = \textcolor{keyword}{new} 
      \hyperlink{class_i_h_m_creation_campagne}{IHMCreationCampagne}(\textcolor{keyword}{this}, listeTechniciens);
00347     ihmCreationCampagne->exec();
00348 \}
00349 
\Hypertarget{ihmaccueil_8cpp_source_l00350}\hyperlink{class_i_h_m_accueil_a5d38917dbe88751ee966834e1f6c558e}{00350} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a5d38917dbe88751ee966834e1f6c558e}{IHMAccueil::archiverCampagne}()
00351 \{
00352     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a7f6a5510b08017b0d99115a84252f186}{ouvrir}(\textcolor{stringliteral}{"campagnes.sqlite"});
00353     \textcolor{keywordtype}{bool} retourRequeteArchiver;
00354     \textcolor{keywordtype}{bool} retourRequeteSuppressionPhoto;
00355     QString requeteArchiver, requeteSuppressionPhoto;
00356 
00357     \hyperlink{class_i_h_m_accueil_a9dc22241cd0d4a227b8b0bf04c6404fd}{supprimerPhotoLocal}(\textcolor{stringliteral}{"SELECT photo.cheminImage FROM photo WHERE photo.IdCampagne = '"}
       + \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{recupererIdCampagne}() + \textcolor{stringliteral}{"' AND photo.aGarder = '0'"});
00358 
00359     requeteArchiver = \textcolor{stringliteral}{"UPDATE campagne SET enCours = '0' WHERE campagne.nom = '"} + 
      \hyperlink{class_i_h_m_accueil_afb828a4e06c25afa40341c310cd85b08}{listeCampagne}->currentText() + \textcolor{stringliteral}{"'"};
00360     requeteSuppressionPhoto = \textcolor{stringliteral}{"DELETE FROM photo WHERE photo.IdCampagne = '"} + 
      \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{recupererIdCampagne}() + \textcolor{stringliteral}{"' AND photo.aGarder = '0'"};
00361 
00362     retourRequeteArchiver = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteArchiver);
00363     retourRequeteSuppressionPhoto = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteSuppressionPhoto);
00364 
00365     \textcolor{keywordflow}{if}(!retourRequeteArchiver && !retourRequeteSuppressionPhoto)
00366     \{
00367 \textcolor{preprocessor}{        #ifdef DEBUG\_BASEDEDONNEES}
00368             qDebug() << Q\_FUNC\_INFO << QString::fromUtf8(\textcolor{stringliteral}{"erreur !"});
00369 \textcolor{preprocessor}{        #endif}
00370     \}
00371     \textcolor{keywordflow}{else}
00372         \hyperlink{class_i_h_m_accueil_a36ce6ecca4e258562577bab1439e0a96}{supprimerCampagneListe}();
00373 \}
00374 
\Hypertarget{ihmaccueil_8cpp_source_l00375}\hyperlink{class_i_h_m_accueil_a0d7c77277fe83ad13beee56d96c5c5ca}{00375} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_a0d7c77277fe83ad13beee56d96c5c5ca}{IHMAccueil::supprimerCampagne}()
00376 \{
00377     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a7f6a5510b08017b0d99115a84252f186}{ouvrir}(\textcolor{stringliteral}{"campagnes.sqlite"});
00378     \textcolor{keywordtype}{bool} retourRequeteSuppressionMesures;
00379     \textcolor{keywordtype}{bool} retourRequeteSuppressionPhotos;
00380     \textcolor{keywordtype}{bool} retourRequeteSuppressionCampagne;
00381 
00382     \hyperlink{class_i_h_m_accueil_a9dc22241cd0d4a227b8b0bf04c6404fd}{supprimerPhotoLocal}(\textcolor{stringliteral}{"SELECT photo.cheminImage FROM photo WHERE photo.IdCampagne = '"}
       + \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{recupererIdCampagne}() + \textcolor{stringliteral}{"'"});
00383 
00384     \hyperlink{class_i_h_m_accueil_acb9679f51e140e0bc28d8ac10afd87e9}{supprimerDossierPhotoLocal}();
00385 
00386     QString requeteSuppressionMesures = \textcolor{stringliteral}{"DELETE FROM mesure WHERE mesure.IdCampagne = '"} + 
      \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{recupererIdCampagne}() + \textcolor{stringliteral}{"'"};
00387     QString requeteSuppressionPhotos = \textcolor{stringliteral}{"DELETE FROM photo WHERE photo.IdCampagne = '"} + 
      \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{recupererIdCampagne}() + \textcolor{stringliteral}{"'"};
00388     QString requeteSuppressionCampagne = \textcolor{stringliteral}{"DELETE FROM campagne WHERE campagne.IdCampagne = '"} + 
      \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{recupererIdCampagne}() + \textcolor{stringliteral}{"'"};
00389 
00390     retourRequeteSuppressionMesures = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(
      requeteSuppressionMesures);
00391     retourRequeteSuppressionPhotos = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(requeteSuppressionPhotos)
      ;
00392     retourRequeteSuppressionCampagne = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(
      requeteSuppressionCampagne);
00393 
00394     \textcolor{keywordflow}{if}(!retourRequeteSuppressionMesures && !retourRequeteSuppressionPhotos && !
      retourRequeteSuppressionCampagne)
00395     \{
00396 \textcolor{preprocessor}{        #ifdef DEBUG\_BASEDEDONNEES}
00397             qDebug() << Q\_FUNC\_INFO << QString::fromUtf8(\textcolor{stringliteral}{"erreur !"});
00398 \textcolor{preprocessor}{        #endif}
00399     \}
00400     \textcolor{keywordflow}{else}
00401         \hyperlink{class_i_h_m_accueil_a36ce6ecca4e258562577bab1439e0a96}{supprimerCampagneListe}();
00402 \}
00403 
\Hypertarget{ihmaccueil_8cpp_source_l00404}\hyperlink{class_i_h_m_accueil_af61976178829ec1fc756bec7eff0354d}{00404} \textcolor{keywordtype}{void} \hyperlink{class_i_h_m_accueil_af61976178829ec1fc756bec7eff0354d}{IHMAccueil::enregisterMesureBDD}(QString temperature, QString humidite, 
      QString radiation)
00405 \{
00406     \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_a7f6a5510b08017b0d99115a84252f186}{ouvrir}(\textcolor{stringliteral}{"campagnes.sqlite"});
00407     \textcolor{keywordtype}{bool} retourRequeteEnregistrementMesure;
00408 
00409     QString requeteEnregistrementMesure = \textcolor{stringliteral}{"INSERT INTO mesure (idCampagne, heure, temperature, radiation,
       humidite) VALUES ("} + \hyperlink{class_i_h_m_accueil_a5e222617897b2c1f7e032fa851aa1700}{recupererIdCampagne}() + \textcolor{stringliteral}{","} + QDateTime::currentDateTime().toString(
      ) + \textcolor{stringliteral}{","} + temperature + \textcolor{stringliteral}{","} + humidite + \textcolor{stringliteral}{","} + radiation + \textcolor{stringliteral}{")"};
00410 
00411     retourRequeteEnregistrementMesure = \hyperlink{class_i_h_m_accueil_ab56d9846c071396a92f88272880e2c1f}{baseDeDonnees}->\hyperlink{class_base_de_donnees_aa8de5f8f8bb17edc43f5c0ee33712081}{executer}(
      requeteEnregistrementMesure);
00412 
00413     \textcolor{keywordflow}{if}(!retourRequeteEnregistrementMesure)
00414     \{
00415 \textcolor{preprocessor}{        #ifdef DEBUG\_BASEDEDONNEES}
00416             qDebug() << Q\_FUNC\_INFO << QString::fromUtf8(\textcolor{stringliteral}{"erreur !"});
00417 \textcolor{preprocessor}{        #endif}
00418     \}
00419 \}
\end{DoxyCode}
